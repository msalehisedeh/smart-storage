!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/wizard-storage",["exports","@angular/core","rxjs","@angular/common"],t):t(((e=e||self).sedeh=e.sedeh||{},e.sedeh["wizard-storage"]={}),e.ng.core,e.rxjs,e.ng.common)}(this,(function(e,t,o,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function s(e,t,o,n){var s,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(i=(r<3?s(i):r>3?s(t,o,i):s(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i}var r=function(){function e(){var e=this;this.subjects={local:{},session:{},cookies:{}},this.session=new Object,this.session.isSupported=function(){return e.isSupported(sessionStorage)},this.session.onchange=function(t){return e.onChange(t,"session")},this.session.setItem=function(t,o,n,s){e.setItem("session",t,o,n,s)},this.session.getItem=function(t,o){return e.getItem("session",t,o)},this.session.hasItem=function(e){return null!==sessionStorage.getItem(e)},this.session.removeItem=function(t){var o=e.subjects.session[t]?e.session.getItem(t):void 0;sessionStorage.removeItem(t),e.subjects.session[t]&&e.subjects.session[t].next({key:t,oldValue:o,newValue:null,url:document.location.href})},this.session.getAllKeys=function(){return e.getAllKeys(sessionStorage)},this.session.clear=function(){sessionStorage.clear()},this.local=new Object,this.local.isSupported=function(){return e.isSupported(localStorage)},this.local.onchange=function(t){return e.onChange(t,"local")},this.local.setItem=function(t,o,n,s){e.setItem("local",t,o,n,s)},this.local.getItem=function(t,o){return e.getItem("local",t,o)},this.local.hasItem=function(e){return null!==localStorage.getItem(e)},this.local.removeItem=function(t){var o=e.subjects.local[t]?e.local.getItem(t):void 0;localStorage.removeItem(t),e.subjects.local[t]&&e.subjects.local[t].next({key:t,oldValue:o,newValue:null,url:document.location.href})},this.local.getAllKeys=function(){return e.getAllKeys(localStorage)},this.local.clear=function(){localStorage.clear()},this.cookies=new Object,this.cookies.isSupported=function(){return!0},this.cookies.onchange=function(t){return e.onChange(t,"cookies")},this.cookies.setItem=function(t,o,n,s,r,i){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var c="; expires=Fri, 31 Dec 9999 23:59:59 GMT";n&&(c="; max-age="+36e5*n);var a=e.cookies.getItem(t),u=o;return"object"==typeof o&&(u=JSON.stringify(o)),document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(u)+c+(s?"; domain="+s:"")+(r?"; path="+r:"")+(i?"; secure":""),e.subjects.cookies[t]&&e.subjects.cookies[t].next({key:t,oldValue:a,newValue:o,url:document.location.href}),!0},this.cookies.getItem=function(t){var o=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;return e.toJson(o)},this.cookies.hasItem=function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},this.cookies.removeItem=function(t,o,n){if(!t||!e.cookies.hasItem(t))return!1;var s=e.subjects.cookies[t]?e.cookies.getItem(t):void 0;return document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(o?"; path="+o:""),e.subjects.cookies[t]&&e.subjects.cookies[t].next({key:t,oldValue:s,newValue:null,url:document.location.href}),!0},this.cookies.getAllKeys=function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e},this.cookies.clear=function(){e.cookies.getAllKeys().map((function(t){e.cookies.removeItem(t)}))}}return e.prototype.isSupported=function(e){try{var t=e.getItem("");return e.removeItem(""),e.setItem("",t),null===t?e.removeItem(""):e.setItem("",t),!0}catch(e){return!1}},e.prototype.getStorageItem=function(e,t){var o;try{(o=(o=e.getItem(t))?JSON.parse(o):{data:o})&&o.data&&(o.data=JSON.parse(o.data))}catch(e){o&&!o.data&&(o={data:o})}return o},e.prototype.getItem=function(e,t,o){var n,s="session"===e?sessionStorage:localStorage,r=this.getStorageItem(s,t);return(n=o&&r.version?o==r.version?r.data:void 0:r.data)&&r.expires&&(new Date).getTime()>=r.expires&&(s.removeItem(t),this.subjects[e][t]&&this.subjects[e][t].next({key:t,oldValue:r,newValue:null,url:document.location.href}),n=void 0),n},e.prototype.setItem=function(e,t,o,n,s){var r="session"===e?sessionStorage:localStorage,i={data:o};if(n&&(i.version=n),null!=s){var c=new Date;c.setTime(c.getTime()+36e5*s),i.expires=c.getTime()}var a=r.getItem(t);try{r.setItem(t,JSON.stringify(i)),this.subjects[e][t]&&this.subjects[e][t].next({key:t,oldValue:a,newValue:i,url:document.location.href})}catch(e){}},e.prototype.getAllKeys=function(e){var t=[];try{for(var o=0;o<e.length;o++)t.push(e.key(o))}catch(e){}return t},e.prototype.onChange=function(e,t){return this.subjects[t][e]||(this.subjects[t][e]=new o.BehaviorSubject(null)),this.subjects[t][e]},e.prototype.toJson=function(e){var t=e;try{t=JSON.parse(e)}catch(e){}return t},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=s([t.Injectable({providedIn:"root"})],e)}(),i=function(){function e(e){this.wizardService=e,this.wizardStorage=new t.EventEmitter}return e.prototype.onHover=function(e){this.wizardStorage.emit({key:e.key,oldValue:this.wizardService.toJson(e.oldValue),newValue:this.wizardService.toJson(e.newValue),url:e.url})},e.ctorParameters=function(){return[{type:r}]},s([t.HostListener("window:storage",["$event"])],e.prototype,"onHover",null),s([t.Output()],e.prototype,"wizardStorage",void 0),e=s([t.Directive({selector:"[wizardStorage]"})],e)}(),c=function(){function e(){}var o;return o=e,e.forRoot=function(){return{ngModule:o,providers:[r]}},e=o=s([t.NgModule({declarations:[i],exports:[i],imports:[n.CommonModule],providers:[r],schemas:[t.CUSTOM_ELEMENTS_SCHEMA]})],e)}();e.WizardStorageDirective=i,e.WizardStorageModule=c,e.WizardStorageService=r,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sedeh-wizard-storage.umd.min.js.map