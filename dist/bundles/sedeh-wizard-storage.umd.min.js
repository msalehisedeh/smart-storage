!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/wizard-storage",["exports","rxjs","@angular/core","@angular/common"],t):t((e.sedeh=e.sedeh||{},e.sedeh["wizard-storage"]={}),e.rxjs,e.ng.core,e.ng.common)}(this,function(e,o,t,n){"use strict";var s=function(){function e(){var u=this;this.subjects={local:{},session:{},cookies:{}},this.session=new Object,this.session.isSupported=function(){return u.isSupported(sessionStorage)},this.session.onchange=function(e){return u.onChange(e,"session")},this.session.setItem=function(e,t,o,n){u.setItem("session",e,t,o,n)},this.session.getItem=function(e,t){return u.getItem("session",e,t)},this.session.hasItem=function(e){return null!==sessionStorage.getItem(e)},this.session.removeItem=function(e){var t=u.subjects.session[e]?u.session.getItem(e):undefined;sessionStorage.removeItem(e),u.subjects.session[e]&&u.subjects.session[e].next({key:e,oldValue:t,newValue:null,url:document.location.href})},this.session.getAllKeys=function(){return u.getAllKeys(sessionStorage)},this.session.clear=function(){sessionStorage.clear()},this.local=new Object,this.local.isSupported=function(){return u.isSupported(localStorage)},this.local.onchange=function(e){return u.onChange(e,"local")},this.local.setItem=function(e,t,o,n){u.setItem("local",e,t,o,n)},this.local.getItem=function(e,t){return u.getItem("local",e,t)},this.local.hasItem=function(e){return null!==localStorage.getItem(e)},this.local.removeItem=function(e){var t=u.subjects.local[e]?u.local.getItem(e):undefined;localStorage.removeItem(e),u.subjects.local[e]&&u.subjects.local[e].next({key:e,oldValue:t,newValue:null,url:document.location.href})},this.local.getAllKeys=function(){return u.getAllKeys(localStorage)},this.local.clear=function(){localStorage.clear()},this.cookies=new Object,this.cookies.isSupported=function(){return!0},this.cookies.onchange=function(e){return u.onChange(e,"cookies")},this.cookies.setItem=function(e,t,o,n,s,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="; expires=Fri, 31 Dec 9999 23:59:59 GMT";o&&(i="; max-age="+36e5*o);var c=u.cookies.getItem(e),a=t;return"object"==typeof t&&(a=JSON.stringify(t)),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(a)+i+(n?"; domain="+n:"")+(s?"; path="+s:"")+(r?"; secure":""),u.subjects.cookies[e]&&u.subjects.cookies[e].next({key:e,oldValue:c,newValue:t,url:document.location.href}),!0},this.cookies.getItem=function(e){var t=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;return u.toJson(t)},this.cookies.hasItem=function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},this.cookies.removeItem=function(e,t,o){if(!e||!u.cookies.hasItem(e))return!1;var n=u.subjects.cookies[e]?u.cookies.getItem(e):undefined;return document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(t?"; path="+t:""),u.subjects.cookies[e]&&u.subjects.cookies[e].next({key:e,oldValue:n,newValue:null,url:document.location.href}),!0},this.cookies.getAllKeys=function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e},this.cookies.clear=function(){u.cookies.getAllKeys().map(function(e){u.cookies.removeItem(e)})}}return e.prototype.isSupported=function(e){try{var t=e.getItem("");return e.removeItem(""),e.setItem("",t),null===t?e.removeItem(""):e.setItem("",t),!0}catch(o){return!1}},e.prototype.getItem=function(e,t,o){var n,s="session"===e?sessionStorage:localStorage,r=s.getItem(t),i={};if(r)try{i=JSON.parse(r)}catch(c){i={data:r}}return(n=o&&i.version?o==i.version?i.data:undefined:i.data)&&i.expires&&(new Date).getTime()>=i.expires&&(s.removeItem(t),this.subjects[e][t]&&this.subjects[e][t].next({key:t,oldValue:i,newValue:null,url:document.location.href}),n=undefined),n},e.prototype.setItem=function(e,t,o,n,s){var r="session"===e?sessionStorage:localStorage,i={data:o};if(n&&(i.version=n),s!=undefined){var c=new Date;c.setTime(c.getTime()+36e5*s),i.expires=c.getTime()}var a=r.getItem(t);r.setItem(t,JSON.stringify(i)),this.subjects[e][t]&&this.subjects[e][t].next({key:t,oldValue:a,newValue:i,url:document.location.href})},e.prototype.getAllKeys=function(e){for(var t=[],o=0;o<e.length;o++)t.push(e.key(o));return t},e.prototype.onChange=function(e,t){return this.subjects[t][e]||(this.subjects[t][e]=new o.BehaviorSubject(null)),this.subjects[t][e]},e.prototype.toJson=function(e){var t=e;try{t=JSON.parse(e)}catch(o){}return t},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}(),r=function(){function e(e){this.wizardService=e,this.wizardStorage=new t.EventEmitter}return e.prototype.onHover=function(e){this.wizardStorage.emit({key:e.key,oldValue:this.wizardService.toJson(e.oldValue),newValue:this.wizardService.toJson(e.newValue),url:e.url})},e.decorators=[{type:t.Directive,args:[{selector:"[wizardStorage]"}]}],e.ctorParameters=function(){return[{type:s}]},e.propDecorators={onHover:[{type:t.HostListener,args:["window:storage",["$event"]]}],wizardStorage:[{type:t.Output}]},e}(),i=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:[r],exports:[r],imports:[n.CommonModule],providers:[s],schemas:[t.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();e.WizardStorageService=s,e.WizardStorageDirective=r,e.WizardStorageModule=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sedeh-wizard-storage.umd.min.js.map